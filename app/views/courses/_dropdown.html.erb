<div class="flex items-center mt-5">
  <% if current_user.enroled?(course) %>
    <% progress = current_user.get_enrolment(course).progress %>
    <div class="w-full bg-gray-200 rounded-full">
      <div id="progressBar" class="bg-indigo-700 text-m font-medium text-white text-center p-0.5 leading-none rounded-full" style="width: <%= progress %>%"> <%= progress %>%</div>
    </div>
  <% else %>
    <div class="w-full bg-gray-200 rounded-full">
      <div id="progressBar" class="bg-green-700 text-m font-medium text-white text-center p-0.5 leading-none rounded-full" style="width: 100%"> <%= t :available %> </div>
    </div>
  <% end %>
  <div class="relative inline-block text-left ml-3">
    <div class="group py-1">
      <button type="button" id="dropdown"
                  class="inline-flex justify-center items-center w-8 h-8 p-1 bg-indigo-500 hover:bg-indigo-600 rounded-lg">
        <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="white">
          <path fill-rule="evenodd" d="M10 12l-5-5h10l-5 5z" />
        </svg>
      </button>
      <div
                  class="absolute left-0 w-40 mt-1 origin-top-left bg-white divide-y divide-gray-100 rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition duration-300">
        <div class="py-1">
          <% if @authored %>
            <% if course.course_lessons.count > 0 %>
              <%= link_to "#{t :read_more}", course_path(course), class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
            <% end %>
            <% if course.course_lessons.count > 1 %>
              <%= link_to "#{t :reorder_lessons}", course_lessons_path(course), class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
            <% end %>
            <%= link_to "#{t :add_lesson}",  new_course_lesson_path(course), class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
            <%= link_to "#{t :edit}", edit_course_path(course), class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
            <%= link_to "#{t :remove}",  course_path(course), data: {turbo_method: :delete }, class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
          <% elsif @available %>
            <% if current_user.enroled?(course) %>
              <%= link_to "#{t :resume}", course_path(course), class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
            <% else %>
              <%= link_to "#{t :read_more}", course_path(course), class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
              <%= link_to "#{t :enrol}", new_course_enrolment_path(course), class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
            <% end %>
          <% elsif @enroled %>
            <%= link_to "#{t :resume}", course_path(course), class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
            <%= link_to "#{t :abandon}", course_enrolment_path(course, current_user.get_enrolment(course)), data: {turbo_method: :delete }, class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
          <%end %>
        </div>
      </div>
    </div>
  </div>
</div>